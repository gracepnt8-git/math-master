<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cçº§ç‰¹è®­ï¼šå®é™…åº”ç”¨ä¸ç»¼åˆå‹è½´</title>
    
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            startup: {
                pageReady: () => {
                    return MathJax.startup.defaultPageReady();
                }
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.bootcdn.net/ajax/libs/mathjax/3.2.2/es5/tex-chtml.min.js"></script>

    <style>
        :root {
            --primary: #880e4f; /* Cçº§ä½¿ç”¨æ·±é…’çº¢ï¼Œä»£è¡¨é«˜éš¾æŒ‘æˆ˜ */
            --quiz: #0d47a1;    /* æµ‹è¯•åŒºæ·±è“ */
            --remedy: #e65100;  /* è¡¥æ•‘æ©™ */
            --deep: #212121;    /* æ·±åº¦é»‘ */
            --bg: #fce4ec;      /* æµ…ç²‰èƒŒæ™¯ */
            --card: #ffffff;
        }

        body { font-family: 'Segoe UI', 'PingFang SC', sans-serif; background: var(--bg); margin: 0; padding: 20px; line-height: 1.6; color: #333; }
        .container { max-width: 800px; margin: 0 auto; }
        
        /* åœºæ™¯åˆ‡æ¢ */
        .scene { display: none; animation: fadeIn 0.5s; }
        .scene.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* å¡ç‰‡æ ·å¼ */
        .card { background: var(--card); padding: 30px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); margin-bottom: 20px; }
        
        h1, h2, h3 { margin-top: 0; color: #263238; }
        
        /* æŒ‰é’® */
        .btn {
            display: inline-block; padding: 12px 24px; border-radius: 6px; cursor: pointer; border: none; font-size: 1rem; color: white; transition: 0.2s;
            width: 100%; text-align: left; margin-bottom: 10px;
        }
        .btn:hover { opacity: 0.9; transform: translateY(-1px); }
        .btn-primary { background: var(--primary); text-align: center; font-weight: bold; width: auto; }
        
        .btn-opt { background: white; color: #333; border: 2px solid #bdbdbd; }
        .btn-opt:hover { background: #f8bbd0; border-color: var(--primary); }
        .btn-opt.selected { background: #f8bbd0; border-color: var(--primary); color: var(--primary); font-weight: bold; }
        .disabled { pointer-events: none; opacity: 0.6; }

        /* Phase 1 æ•™å­¦åŒº */
        .study-header { border-left: 5px solid var(--primary); padding-left: 15px; margin-bottom: 20px; }
        .model-box { background: #fff9c4; border: 1px solid #fbc02d; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
        .model-title { font-weight: bold; color: #f57f17; margin-bottom: 5px; display: block; }

        /* Phase 3 è¡¥æ•‘åŒº */
        .remedy-header { background: #ffe0b2; color: #e65100; padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #ffcc80; }
        .deep-dive-box {
            display: none; background: #eceff1; border: 2px dashed var(--deep); padding: 15px; border-radius: 8px; margin-top: 15px; animation: slideDown 0.5s;
        }
        @keyframes slideDown { from { opacity:0; transform:translateY(-10px); } to { opacity:1; transform:translateY(0); } }
        .step-item { margin-bottom: 8px; padding-left: 10px; border-left: 3px solid var(--deep); }

        /* è¿›åº¦æ¡ */
        .progress-bar { height: 8px; background: #e0e0e0; border-radius: 4px; margin-bottom: 20px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--quiz); width: 0%; transition: width 0.3s; }
    </style>
</head>
<body>

<div class="container">

    <div id="scene-study" class="scene active">
        <div class="card">
            <div class="study-header">
                <h1>Cçº§ï¼šåº”ç”¨å»ºæ¨¡ä¸å‹è½´</h1>
                <p>è¿™ä¸€å…³æ˜¯ä¸­è€ƒçš„å†³èƒœå±€ã€‚æˆ‘ä»¬è¦å­¦ä¼šæŠŠç°å®é—®é¢˜â€œç¿»è¯‘â€æˆæ•°å­¦å…¬å¼ã€‚</p>
            </div>
            
            <div class="model-box">
                <span class="model-title">æ¨¡å‹1ï¼šåˆ©æ¶¦æœ€å¤§åŒ– (ç»å•†æ¨¡å‹)</span>
                <p><strong>å…¬å¼ï¼šæ€»åˆ©æ¶¦ = å•ä»¶åˆ©æ¶¦ $\times$ é”€é‡</strong></p>
                <p>è®¾æ¶¨ä»·/é™ä»· $x$ å…ƒï¼š</p>
                <ul>
                    <li>å•ä»¶åˆ©æ¶¦ = (åŸå”®ä»· $\pm x$) - è¿›ä»·</li>
                    <li>é”€é‡ = åŸé”€é‡ $\mp$ ($k \cdot x$)</li>
                    <li>è§£æå¼ï¼š$y = (\text{æ–°åˆ©}) \times (\text{æ–°é‡})$</li>
                </ul>
            </div>

            <div class="model-box" style="background: #e1f5fe; border-color: #039be5;">
                <span class="model-title" style="color: #0277bd;">æ¨¡å‹2ï¼šå‡ ä½•é¢ç§¯ (å›´ç¯±ç¬†æ¨¡å‹)</span>
                <p><strong>æ ¸å¿ƒï¼šåˆ©ç”¨å‘¨é•¿å…³ç³»è¡¨ç¤ºè¾¹é•¿</strong></p>
                <ul>
                    <li>è‹¥çŸ©å½¢å‘¨é•¿å›ºå®šï¼š$y = x \cdot (\frac{C}{2} - x)$</li>
                    <li><strong>é å¢™é™·é˜±ï¼š</strong> å¢™é‚£è¾¹ä¸éœ€è¦ç¯±ç¬†ï¼<br>é•¿ = æ€»é•¿ - 2 $\times$ å®½ (è®¾å®½ä¸ºx)</li>
                </ul>
            </div>

            <div class="model-box" style="background: #f3e5f5; border-color: #8e24aa;">
                <span class="model-title" style="color: #7b1fa2;">æ¨¡å‹3ï¼šé“…å‚é«˜æ³• (æ±‚ä¸è§„åˆ™ä¸‰è§’å½¢é¢ç§¯)</span>
                <p>åœ¨åæ ‡ç³»ä¸­æ±‚ $\triangle ABC$ é¢ç§¯ï¼Œé€šå¸¸åšè¾…åŠ©çº¿åˆ‡å‰²ï¼š</p>
                <p>$$ S = \frac{1}{2} \times \text{æ°´å¹³å®½} \times \text{é“…å‚é«˜} $$</p>
                <p><strong>æ°´å¹³å®½ï¼š</strong> $|x_A - x_B|$<br><strong>é“…å‚é«˜ï¼š</strong> ä¸Šæ–¹ç‚¹çºµåæ ‡ - ä¸‹æ–¹ç‚¹çºµåæ ‡</p>
            </div>

            <button class="btn btn-primary" style="width:100%; margin-top:20px;" onclick="startQuiz()">æˆ‘æŒæ¡äº†æ¨¡å‹ï¼Œå¼€å§‹æŒ‘æˆ˜ â¡</button>
        </div>
    </div>

    <div id="scene-quiz" class="scene">
        <div class="card">
            <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                <span style="font-weight:bold; color:var(--quiz);">Cçº§ å»ºæ¨¡æµ‹è¯•</span>
                <span id="quiz-progress-text">1 / 6</span>
            </div>
            <div class="progress-bar"><div class="progress-fill" id="quiz-progress-fill"></div></div>

            <h3 id="quiz-question-text">...</h3>
            <div id="quiz-options-container"></div>
            <button id="quiz-next-btn" class="btn btn-primary" style="margin-top:20px; display:none;">ä¸‹ä¸€é¢˜</button>
        </div>
    </div>

    <div id="scene-remedy" class="scene">
        <div class="card" style="border-top: 5px solid var(--remedy);">
            <div class="remedy-header">
                <h3>âš ï¸ å»ºæ¨¡é€»è¾‘è¯Šæ–­</h3>
                <p>ä½ åœ¨â€œç¿»è¯‘â€é¢˜ç›®æ¡ä»¶æ—¶å‡ºç°äº†åå·®ã€‚æˆ‘ä»¬æ¥ä¿®æ­£æ¨¡å‹ã€‚</p>
            </div>

            <div style="margin-bottom:20px; border-bottom:1px solid #eee; padding-bottom:15px;">
                <p><strong>âŒ åŸé¢˜å›é¡¾ï¼š</strong> <span id="remedy-original-question">...</span></p>
                <div style="background:#fff3e0; padding:15px; border-radius:8px; color:#555;">
                    <strong>ğŸ“– å»ºæ¨¡æ€è·¯ï¼š</strong> <span id="remedy-explanation">...</span>
                </div>
            </div>

            <h4 style="color:var(--remedy);">âœï¸ å˜å¼æŒ‘æˆ˜ï¼š</h4>
            <p id="variant-question-text" style="font-weight:bold;">...</p>
            <div id="variant-options-container"></div>
            
            <div id="deep-dive-box" class="deep-dive-box">
                <h4 style="color:var(--deep); margin-top:0;">ğŸš¨ ä¾ç„¶åšé”™ï¼Ÿå¯åŠ¨ã€åˆ†æ­¥æ‹†è§£ã€‘</h4>
                <div id="deep-steps"></div>
                <div style="margin-top:15px; text-align:right;">
                    <button class="btn btn-primary" style="background:var(--deep); width:auto;" onclick="retryVariant()">ğŸ”„ é‡åšæ­¤é¢˜</button>
                </div>
            </div>

            <div id="variant-feedback" style="margin-top:15px; font-weight:bold; min-height:30px;"></div>
            <button id="remedy-next-btn" class="btn btn-primary" style="margin-top:20px; display:none;" onclick="nextRemedyItem()">ä¸‹ä¸€é¡¹è¯Šæ–­ â¡</button>
        </div>
    </div>

    <div id="scene-result" class="scene">
        <div class="card" style="text-align: center;">
            <div style="font-size: 4em; margin-bottom: 10px;">ğŸ†</div>
            <h2>Cçº§ å‹è½´é€šå…³</h2>
            <div id="result-details" style="text-align: left; margin: 20px 0; background: #f5f5f5; padding: 20px; border-radius: 8px;"></div>
            <button class="btn btn-primary" onclick="location.reload()">å†æ¥ä¸€æ¬¡</button>
        </div>
    </div>

</div>

<script>
    // =========================================================
    // Cçº§æ ¸å¿ƒé¢˜åº“ï¼šåº”ç”¨ä¸å‹è½´
    // =========================================================
    const questionBank = [
        // ã€C-01ã€‘åˆ©æ¶¦é—®é¢˜ï¼šåˆ—å¼
        {
            id: "C-01", type: "main",
            question: "æŸå•†å“è¿›ä»· 40 å…ƒï¼Œå”®ä»· 60 å…ƒï¼Œæ—¥é”€ 300 ä»¶ã€‚ç»è°ƒæŸ¥ï¼Œå”®ä»·æ¯æ¶¨ 1 å…ƒï¼Œæ—¥é”€å‡å°‘ 10 ä»¶ã€‚è®¾æ¶¨ä»· $x$ å…ƒï¼Œæ—¥æ€»åˆ©æ¶¦ä¸º $y$ï¼Œåˆ™ $y$ ä¸ $x$ çš„å…³ç³»å¼ä¸ºï¼Ÿ",
            options: ["$y=(60+x)(300-10x)$", "$y=(20+x)(300-10x)$", "$y=(60+x-40)(300+10x)$", "$y=(20-x)(300+10x)$"],
            correct: 1, 
            remediation: {
                explanation: "<strong>åˆ©æ¶¦å…¬å¼ï¼š</strong> æ€»åˆ© = (å”®ä»·-è¿›ä»·) Ã— é”€é‡ã€‚<br>1. æ–°å”®ä»·ï¼š$60+x$ï¼›<br>2. å•ä»¶åˆ©ï¼š$(60+x) - 40 = 20+x$ï¼›<br>3. æ–°é”€é‡ï¼š$300 - 10x$ã€‚<br>ç›¸ä¹˜å¾—ï¼š$y=(20+x)(300-10x)$ã€‚",
                variant: {
                    question: "è¿›ä»·30ï¼Œå”®ä»·50ï¼Œé”€é‡100ã€‚é™ä»·1å…ƒï¼Œé”€é‡å¢5ä»¶ã€‚è®¾é™ä»·xå…ƒï¼Œæ€»åˆ©æ¶¦yï¼Ÿ",
                    options: ["$y=(20-x)(100+5x)$", "$y=(50-x)(100+5x)$", "$y=(20+x)(100-5x)$", "$y=(50-x-30)(100-5x)$"],
                    correct: 0
                },
                stepByStep: [
                    "ç¬¬ä¸€æ­¥ï¼šç®—å•ä»¶åˆ©æ¶¦ã€‚åŸåˆ© $50-30=20$ã€‚é™ä»· $x$ï¼Œæ‰€ä»¥æ˜¯ $(20-x)$ã€‚",
                    "ç¬¬äºŒæ­¥ï¼šç®—é”€é‡ã€‚åŸé‡100ã€‚é™ä»·ä¿ƒé”€ï¼Œé‡å¢åŠ ï¼Œæ‰€ä»¥æ˜¯ $(100+5x)$ã€‚",
                    "ç¬¬ä¸‰æ­¥ï¼šä¸¤é¡¹ç›¸ä¹˜ã€‚$y=(20-x)(100+5x)$ã€‚"
                ]
            }
        },
        // ã€C-02ã€‘åˆ©æ¶¦é—®é¢˜ï¼šæ±‚æœ€å€¼
        {
            id: "C-02", type: "main",
            question: "åˆ©æ¶¦å‡½æ•° $y = -10(x-15)^2 + 4000$ï¼Œå…¶ä¸­ $x$ ä¸ºæ¶¨ä»·é‡‘é¢ã€‚è¦æƒ³è·å¾—æœ€å¤§åˆ©æ¶¦ï¼Œå”®ä»·åº”å®šä¸ºå¤šå°‘ï¼Ÿï¼ˆåŸå”®ä»·60å…ƒï¼‰",
            options: ["15å…ƒ", "60å…ƒ", "75å…ƒ", "4000å…ƒ"],
            correct: 2, 
            remediation: {
                explanation: "1. è¿™æ˜¯ä¸€ä¸ªé¡¶ç‚¹å¼ï¼Œå¼€å£å‘ä¸‹ï¼Œæœ‰æœ€å¤§å€¼ã€‚<br>2. å½“ $x=15$ æ—¶ï¼Œåˆ©æ¶¦æœ€å¤§ã€‚<br>3. é¢˜ç›®é—®çš„æ˜¯<strong>å”®ä»·</strong>ï¼Œä¸æ˜¯æ¶¨ä»·é‡‘é¢ã€‚<br>4. å”®ä»· = åŸä»· + æ¶¨ä»· = $60 + 15 = 75$ å…ƒã€‚",
                variant: {
                    question: "è‹¥åˆ©æ¶¦ $y = -2(x-10)^2 + 500$ ($x$ä¸ºå”®ä»·)ï¼Œåˆ™æœ€å¤§åˆ©æ¶¦æ—¶çš„å”®ä»·æ˜¯ï¼Ÿ",
                    options: ["10å…ƒ", "500å…ƒ", "2å…ƒ", "20å…ƒ"],
                    correct: 0
                },
                stepByStep: [
                    "ç¬¬ä¸€æ­¥ï¼šçœ‹é¡¶ç‚¹ã€‚é¡¶ç‚¹æ¨ªåæ ‡æ˜¯ $x=10$ã€‚",
                    "ç¬¬äºŒæ­¥ï¼šçœ‹å®šä¹‰ã€‚é¢˜ç›®ç›´æ¥è¯´ $x$ å°±æ˜¯å”®ä»·ã€‚",
                    "ç¬¬ä¸‰æ­¥ï¼šæ‰€ä»¥å½“å”®ä»·ä¸º 10 æ—¶ï¼Œåˆ©æ¶¦æœ€å¤§ã€‚"
                ]
            }
        },
        // ã€C-03ã€‘å‡ ä½•åº”ç”¨ï¼šå›´ç¯±ç¬† (é å¢™)
        {
            id: "C-03", type: "main",
            question: " ç”¨é•¿ 20m çš„ç¯±ç¬†å›´æˆä¸€ä¸ªä¸€è¾¹é å¢™çš„çŸ©å½¢ï¼Œå¢™é•¿è¶³å¤Ÿã€‚è®¾å‚ç›´äºå¢™çš„è¾¹é•¿ä¸º $x$ï¼Œé¢ç§¯ä¸º $y$ï¼Œåˆ™ï¼Ÿ",
            options: ["$y = x(20-x)$", "$y = x(20-2x)$", "$y = x(10-x)$", "$y = x(20-2x)/2$"],
            correct: 1, 
            remediation: {
                explanation: "<strong>é å¢™æ¨¡å‹ï¼š</strong><br>1. è®¾å®½(å‚ç›´å¢™)ä¸º $x$ã€‚<br>2. åªæœ‰ä¸‰æ¡è¾¹ï¼šä¸¤ä¸ªå®½ï¼Œä¸€ä¸ªé•¿ã€‚<br>3. é•¿ = æ€»ç¯±ç¬† - 2ä¸ªå®½ = $20 - 2x$ã€‚<br>4. é¢ç§¯ = é•¿ $\\times$ å®½ = $x(20-2x)$ã€‚",
                variant: {
                    question: "è‹¥å›´æˆçŸ©å½¢ä¸”ä¸­é—´åŠ ä¸€é“éš”æ¿ï¼ˆä¸é å¢™ï¼‰ï¼Œæ€»é•¿20mï¼Œè®¾å®½xï¼Œé¢ç§¯yï¼Ÿ",
                    options: ["$y=x(20-2x)$", "$y=x(20-3x)$", "$y=x(20-3x)/2$", "$y=x(10-1.5x)$"],
                    correct: 1
                },
                stepByStep: [
                    "ç¬¬ä¸€æ­¥ï¼šæ•°è¾¹ã€‚ä¸¤ä¸ªå¤–å®½ + ä¸€ä¸ªä¸­é—´éš”æ¿ = 3ä¸ªå®½($x$)ã€‚",
                    "ç¬¬äºŒæ­¥ï¼šç®—é•¿ã€‚é•¿ = æ€»é•¿ - 3ä¸ªå®½ = $20 - 3x$ã€‚",
                    "ç¬¬ä¸‰æ­¥ï¼šç®—é¢ç§¯ã€‚$y = x(20 - 3x)$ã€‚"
                ]
            }
        },
        // ã€C-04ã€‘é“…å‚é«˜æ³•æ±‚é¢ç§¯
        {
            id: "C-04", type: "main",
            question: "æŠ›ç‰©çº¿ $y=x^2$ ä¸ç›´çº¿ $y=x+2$ äº¤äº $A(-1,1), B(2,4)$ã€‚ç‚¹Påœ¨æŠ›ç‰©çº¿ä¸Šä¸”åœ¨ç›´çº¿ä¸‹æ–¹ã€‚æ±‚ $\\triangle PAB$ é“…å‚é«˜ $h$ æœ€å¤§æ—¶ P çš„æ¨ªåæ ‡ï¼Ÿ",
            options: ["0.5", "1", "0", "-0.5"],
            correct: 0, 
            remediation: {
                explanation: "<strong>é“…å‚é«˜æœ€å¤§åŸç†ï¼š</strong><br>é“…å‚é«˜ $h = y_{ç›´çº¿} - y_{æŠ›ç‰©çº¿} = (x+2) - x^2$ã€‚<br>è¿™æ˜¯ä¸€ä¸ªå¼€å£å‘ä¸‹çš„äºŒæ¬¡å‡½æ•° $-x^2+x+2$ã€‚<br>å¯¹ç§°è½´ $x = -b/2a = -1 / (2 \\times -1) = 0.5$ã€‚",
                variant: {
                    question: "è‹¥é“…å‚é«˜è¡¨è¾¾å¼ä¸º $h = -2x^2 + 4x + 1$ï¼Œåˆ™ $h$ çš„æœ€å¤§å€¼æ˜¯ï¼Ÿ",
                    options: ["1", "3", "2", "4"],
                    correct: 1
                },
                stepByStep: [
                    "ç¬¬ä¸€æ­¥ï¼šæ±‚å¯¹ç§°è½´ã€‚$x = -4 / (2 \\times -2) = 1$ã€‚",
                    "ç¬¬äºŒæ­¥ï¼šæŠŠ $x=1$ ä»£å…¥è¡¨è¾¾å¼ã€‚",
                    "ç¬¬ä¸‰æ­¥ï¼š$h = -2(1)^2 + 4(1) + 1 = -2 + 4 + 1 = 3$ã€‚"
                ]
            }
        },
        // ã€C-05ã€‘æŠ›ç‰©çº¿ä¸­çš„ç›´è§’ä¸‰è§’å½¢ (å­˜åœ¨æ€§)
        {
            id: "C-05", type: "main",
            question: "å·²çŸ¥ $A(-1,0), B(3,0)$ã€‚ç‚¹ $P$ åœ¨æŠ›ç‰©çº¿ $y=x^2-2x-3$ ä¸Šã€‚è‹¥ $\\triangle PAB$ æ˜¯ç›´è§’ä¸‰è§’å½¢ï¼Œåˆ™è¿™æ ·çš„ç‚¹ $P$ æœ‰å‡ ä¸ªï¼Ÿ",
            options: ["2ä¸ª", "3ä¸ª", "4ä¸ª", "6ä¸ª"],
            correct: 1, 
            remediation: {
                explanation: "<strong>åˆ†ç±»è®¨è®ºï¼š</strong><br>1. $\\angle PAB=90^\\circ$ï¼š$P$åœ¨è¿‡$A$çš„å‚çº¿ä¸Š ($x=-1$)ã€‚ä»£å…¥æŠ›ç‰©çº¿æ±‚Påæ ‡ã€‚<br>2. $\\angle PBA=90^\\circ$ï¼š$P$åœ¨è¿‡$B$çš„å‚çº¿ä¸Š ($x=3$)ã€‚<br>3. $\\angle APB=90^\\circ$ï¼š$P$åœ¨ä»¥$AB$ä¸ºç›´å¾„çš„åœ†ä¸æŠ›ç‰©çº¿äº¤ç‚¹ä¸Šã€‚<br>æœ¬é¢˜ç‰¹æ®Šï¼š$A,B$ä¹Ÿæ˜¯æŠ›ç‰©çº¿ä¸xè½´äº¤ç‚¹ã€‚$x=-1$æ—¶$y=0$(é‡åˆA,èˆ)ï¼›$x=3$æ—¶$y=0$(é‡åˆB,èˆ)ã€‚<br>å‰©ä¸‹çœ‹åœ†ï¼š$AB$ä¸­ç‚¹$(1,0)$ï¼ŒåŠå¾„2ã€‚åœ†æ–¹ç¨‹$(x-1)^2+y^2=4$ã€‚ç”»å›¾å¯çŸ¥æœ‰3ä¸ªäº¤ç‚¹ã€‚",
                variant: {
                    question: "ç®€å•ç‚¹ï¼šè‹¥ $A(0,0)$ï¼Œç‚¹Påœ¨ $y=x^2-2x$ ä¸Šï¼Œä¸” $\\angle PAO=90^\\circ$ (Oä¸ºåŸç‚¹)ï¼Œæ±‚Pç‚¹åæ ‡ï¼Ÿ",
                    options: ["$(0,0)$", "$(2,0)$", "ä¸å­˜åœ¨", "$(0,-2)$"],
                    correct: 2
                },
                stepByStep: [
                    "ç¬¬ä¸€æ­¥ï¼š$\\angle PAO=90^\\circ$ æ„å‘³ç€ $PA \\perp$ xè½´ã€‚",
                    "ç¬¬äºŒæ­¥ï¼šæ‰€ä»¥ P ç‚¹æ¨ªåæ ‡å¿…é¡»ä¸ A ç‚¹ç›¸åŒï¼Œå³ $x=0$ã€‚",
                    "ç¬¬ä¸‰æ­¥ï¼šå½“ $x=0$ æ—¶ï¼Œä»£å…¥æŠ›ç‰©çº¿ $y=0$ã€‚Pç‚¹å˜æˆ $(0,0)$ï¼Œä¸Aç‚¹é‡åˆï¼Œæ— æ³•æ„æˆä¸‰è§’å½¢ã€‚æ‰€ä»¥ä¸å­˜åœ¨ã€‚"
                ]
            }
        },
        // ã€C-06ã€‘å®é™…åº”ç”¨ï¼šæ‹±æ¡¥é—®é¢˜
        {
            id: "C-06", type: "main",
            question: "ä¸€åº§æ‹±æ¡¥å‘ˆæŠ›ç‰©çº¿å½¢ï¼Œè·¨åº¦ 40mï¼Œæ‹±é«˜ 20mã€‚ä»¥æ‹±é¡¶ä¸ºåŸç‚¹å»ºç«‹åæ ‡ç³»ï¼Œåˆ™æŠ›ç‰©çº¿è§£æå¼ä¸ºï¼Ÿ",
            options: ["$y = -\\frac{1}{20}x^2$", "$y = -\\frac{1}{40}x^2$", "$y = -\\frac{1}{20}(x-20)^2$", "$y = -20x^2$"],
            correct: 0, 
            remediation: {
                explanation: "1. é¡¶ç‚¹ä¸ºåŸç‚¹ $\\rightarrow y=ax^2$ã€‚<br>2. å¼€å£å‘ä¸‹ $\\rightarrow a<0$ã€‚<br>3. è·¨åº¦40m $\\rightarrow$ å·¦å³å„20mã€‚æ‰€ä»¥ç»è¿‡ç‚¹ $(20, -20)$ã€‚<br>4. ä»£å…¥ï¼š$-20 = a \\times 20^2 \\rightarrow -20 = 400a \\rightarrow a = -1/20$ã€‚",
                variant: {
                    question: "è‹¥ä»¥å·¦ä¾§æ¡¥å¢©åº•éƒ¨ä¸ºåŸç‚¹ï¼Œåˆ™é¡¶ç‚¹åæ ‡æ˜¯ï¼Ÿ",
                    options: ["$(20, 20)$", "$(40, 20)$", "$(0, 20)$", "$(20, 0)$"],
                    correct: 0
                },
                stepByStep: [
                    "ç¬¬ä¸€æ­¥ï¼šç”»å›¾ã€‚æ¡¥è·¨åº¦40ï¼Œé«˜20ã€‚",
                    "ç¬¬äºŒæ­¥ï¼šå®šåŸç‚¹ã€‚å·¦è„šæ˜¯ $(0,0)$ã€‚",
                    "ç¬¬ä¸‰æ­¥ï¼šæ‰¾é¡¶ç‚¹ã€‚æ°´å¹³æ–¹å‘èµ°ä¸€åŠ(20)ï¼Œå‚ç›´æ–¹å‘èµ°æœ€é«˜(20)ã€‚æ‰€ä»¥æ˜¯ $(20, 20)$ã€‚"
                ]
            }
        }
    ];

    // ================= é€»è¾‘æ§åˆ¶ (æ ‡å‡†ç‰ˆ) =================
    let userAnswers = [];
    let wrongIndices = [];
    let currentQuizIndex = 0;
    let currentRemedyIndex = 0;
    let criticalFailures = 0;

    function startQuiz() {
        switchScene('scene-quiz');
        loadQuizQuestion();
    }

    function loadQuizQuestion() {
        const q = questionBank[currentQuizIndex];
        document.getElementById('quiz-progress-text').innerText = `${currentQuizIndex + 1} / ${questionBank.length}`;
        document.getElementById('quiz-progress-fill').style.width = `${((currentQuizIndex+1)/questionBank.length)*100}%`;
        document.getElementById('quiz-question-text').innerHTML = q.question;
        const container = document.getElementById('quiz-options-container');
        container.innerHTML = '';
        q.options.forEach((opt, idx) => {
            const btn = document.createElement('button');
            btn.className = 'btn btn-opt';
            btn.innerHTML = opt;
            btn.onclick = () => selectQuizOption(idx, btn);
            container.appendChild(btn);
        });
        document.getElementById('quiz-next-btn').style.display = 'none';
        renderMath();
    }

    function selectQuizOption(idx, btn) {
        document.querySelectorAll('#quiz-options-container .btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        userAnswers[currentQuizIndex] = idx;
        const nextBtn = document.getElementById('quiz-next-btn');
        nextBtn.style.display = 'block';
        if (currentQuizIndex === questionBank.length - 1) {
            nextBtn.innerText = "æäº¤è¯•å·";
            nextBtn.onclick = submitQuiz;
        } else {
            nextBtn.innerText = "ä¸‹ä¸€é¢˜";
            nextBtn.onclick = () => { currentQuizIndex++; loadQuizQuestion(); };
        }
    }

    function submitQuiz() {
        wrongIndices = [];
        questionBank.forEach((q, idx) => {
            if (userAnswers[idx] !== q.correct) wrongIndices.push(idx);
        });
        if (wrongIndices.length === 0) showResult(true);
        else {
            alert(`åœ¨å»ºæ¨¡ä¸åº”ç”¨ä¸­æœ‰ ${wrongIndices.length} ä¸ªéš¾ç‚¹æœªæ”»å…‹ï¼Œè¿›å…¥æ™ºèƒ½ä¿®å¤ã€‚`);
            startRemediation();
        }
    }

    function startRemediation() {
        currentRemedyIndex = 0;
        criticalFailures = 0;
        switchScene('scene-remedy');
        loadRemedyItem();
    }

    function loadRemedyItem() {
        const idx = wrongIndices[currentRemedyIndex];
        const data = questionBank[idx];
        document.getElementById('remedy-original-question').innerHTML = data.question;
        document.getElementById('remedy-explanation').innerHTML = data.remediation.explanation;
        document.getElementById('variant-question-text').innerHTML = data.remediation.variant.question;
        document.getElementById('deep-dive-box').style.display = 'none';
        document.getElementById('remedy-next-btn').style.display = 'none';
        document.getElementById('variant-feedback').innerHTML = '';
        renderVariantOptions(data, false);
        renderMath();
    }

    function renderVariantOptions(data, isRetry) {
        const container = document.getElementById('variant-options-container');
        container.innerHTML = '';
        data.remediation.variant.options.forEach((opt, idx) => {
            const btn = document.createElement('button');
            btn.className = 'btn btn-opt';
            btn.innerHTML = opt;
            btn.onclick = () => checkVariantAnswer(idx, btn, data, isRetry);
            container.appendChild(btn);
        });
        renderMath();
    }

    function checkVariantAnswer(userIdx, btn, data, isRetry) {
        const correctIdx = data.remediation.variant.correct;
        const allBtns = document.querySelectorAll('#variant-options-container .btn');
        allBtns.forEach(b => b.classList.add('disabled'));

        if (userIdx === correctIdx) {
            btn.style.backgroundColor = '#dcedc8'; btn.style.borderColor = '#2e7d32';
            document.getElementById('variant-feedback').innerHTML = '<span style="color:green">âœ… å»ºæ¨¡æˆåŠŸï¼</span>';
            document.getElementById('remedy-next-btn').style.display = 'inline-block';
        } else {
            btn.style.backgroundColor = '#ffcdd2'; btn.style.borderColor = '#c62828';
            if (!isRetry) {
                document.getElementById('variant-feedback').innerHTML = '<span style="color:#c62828">âŒ æ¨¡å‹å»ºç«‹å¤±è´¥ã€‚è¯·çœ‹ä¸‹æ–¹çš„ã€åˆ†æ­¥æ‹†è§£ã€‘ã€‚ğŸ‘‡</span>';
                showDeepDive(data);
            } else {
                criticalFailures++;
                allBtns[correctIdx].style.backgroundColor = '#dcedc8';
                document.getElementById('variant-feedback').innerHTML = '<span style="color:red">ğŸ†˜ æ­¤ç±»å‹è½´é¢˜å»ºè®®æ”¾å¼ƒæˆ–å¯»æ±‚è€å¸ˆä¸€å¯¹ä¸€æŒ‡å¯¼ã€‚</span>';
                document.getElementById('remedy-next-btn').style.display = 'inline-block';
            }
        }
    }

    function showDeepDive(data) {
        const box = document.getElementById('deep-dive-box');
        const stepsDiv = document.getElementById('deep-steps');
        stepsDiv.innerHTML = '';
        data.remediation.stepByStep.forEach(step => {
            const div = document.createElement('div');
            div.className = 'step-item';
            div.innerHTML = step;
            stepsDiv.appendChild(div);
        });
        box.style.display = 'block';
        renderMath();
        box.scrollIntoView({behavior: "smooth"});
    }

    function retryVariant() {
        const idx = wrongIndices[currentRemedyIndex];
        const data = questionBank[idx];
        document.getElementById('deep-dive-box').style.display = 'none';
        document.getElementById('variant-feedback').innerHTML = '';
        renderVariantOptions(data, true);
    }

    function nextRemedyItem() {
        currentRemedyIndex++;
        if (currentRemedyIndex < wrongIndices.length) loadRemedyItem();
        else showResult(false);
    }

    function showResult(isPerfect) {
        switchScene('scene-result');
        const div = document.getElementById('result-details');
        if (isPerfect) {
            div.innerHTML = "<h3 style='color:green'>Cçº§å‹è½´åˆ¶éœ¸ï¼ğŸ†</h3><p>ä½ å·²ç»å…·å¤‡äº†è§£ç­”ä¸­è€ƒæœ€åä¸¤é“å¤§é¢˜çš„å»ºæ¨¡èƒ½åŠ›ï¼</p>";
        } else {
            let html = `<p>åˆæµ‹å¾—åˆ†ï¼š${questionBank.length - wrongIndices.length} / ${questionBank.length}</p>`;
            html += `<p>ä¿®å¤äº† ${wrongIndices.length} ä¸ªå»ºæ¨¡æ¼æ´ã€‚</p>`;
            if (criticalFailures > 0) {
                html += `<div style="background:#ffebee; padding:10px; border-left:4px solid red; margin-top:10px;"><strong>ğŸš¨ å»ºè®®ï¼š</strong> æœ‰ ${criticalFailures} ä¸ªå‹è½´æ¨¡å‹æœªæŒæ¡ï¼Œå»ºè®®å¤ä¹ ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹åº”ç”¨é¢˜ã€‚</div>`;
            } else {
                html += `<div style="background:#e8f5e9; padding:10px; border-left:4px solid green; margin-top:10px;">âœ… æ‰€æœ‰æ¨¡å‹å·²ä¿®æ­£ã€‚</div>`;
            }
            div.innerHTML = html;
        }
    }

    function switchScene(id) {
        document.querySelectorAll('.scene').forEach(e => e.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        window.scrollTo(0, 0);
    }
    
    function renderMath() {
        if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) MathJax.typesetPromise();
    }
</script>

</body>
</html>